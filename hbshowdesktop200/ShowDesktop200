RexxButton
BGNDCOL=CCCCCC;TEXTCOL=000084;SCRIPT=/* Show desktop (by minimizing windows) or restore minimized windows */%0D%0A%0D%0Aexception.1%3D"Desktop" /* "Arbeitsoberfl„che" */%0D%0Aexception.2%3D"Window List" /* "Fensterliste" */%0D%0Aexception.3%3D"Seamless Window"%0D%0Aexception.4%3D"Toolbar" /* "Klickstartleiste"  "LaunchPad" */%0D%0Aexception.5%3D"Control Center"%0D%0Aexception.6%3D"Tab LaunchPad"%0D%0Aexception.0 %3D 6  /* must be the number of exceptions you have defined */%0D%0A%0D%0Acall RxFuncAdd 'VRLoadFuncs', 'VROBJ', 'VRLoadFuncs'%0D%0Acall VRLoadFuncs%0D%0A%0D%0Aif button.user%3D'' then RestoreMode%3D0%3B else RestoreMode%3D1%0D%0Aif arg(3) <> 0 then RestoreMode%3D0%0D%0A%0D%0Aif \RestoreMode then do%0D%0A%09ModWins%3D''%0D%0A%09ok %3D VRMethod( "Screen", "ListWindows", "windows.") %0D%0A%09do I %3D 1 to windows.0%0D%0A%09%09PMWH %3D word(windows.I,1)%0D%0A%09%09WinState%3DVrGet(PMWH,"Windowstate")%0D%0A%09%09Caption%3DVrGet(PMWH,"Caption")%0D%0A%09%09if (WinState %3D 'Normal' | WinState%3D'Maximized') & Caption <> ""then do%0D%0A%09%09%09Do J %3D 1 to exception.0%0D%0A%09%09%09%09if pos(exception.J, Caption) > 0 then leave%0D%0A%09%09%09end%0D%0A%09%09%09if J %3D exception.0 + 1 then do%0D%0A%09%09%09%09call lineout Profile,PMWH' 'WinState%0D%0A%09%09%09%09ModWins%3DModWins' 'PMWH' 'WinState%0D%0A%09%09%09%09ok %3D VRMethod(PMWH,"Minimize")%0D%0A%09%09%09end%0D%0A%09%09end%0D%0A%09end%0D%0A%09button.user%3DModWins%0D%0A%09button.tooltip%3D'Restore windows'%0D%0Aend%0D%0Aelse do /* Restore Mode */%0D%0A%09ModWins%3Dbutton.user%0D%0A%09do I %3D 1 to words(ModWins) by 2%0D%0A%09%09PMWH%3Dword(ModWins,I)%0D%0A%09%09Winstate%3Dword(ModWins,I+1)%0D%0A%09%09if Winstate%3D'Normal' then ok %3D VRMethod(PMWH,"Restore")%0D%0A%09%09%09else ok %3D VRMethod(PMWH,"Maximize")%0D%0A%09end%0D%0A%09button.user%3D''%0D%0A%09button.tooltip%3D'Show desktop'%0D%0Aend%0D%0Aexit;TITLE=Herwig' Minimize/restore windows widget;ICONFILE=Y:\HBShowDesktop.ICO;